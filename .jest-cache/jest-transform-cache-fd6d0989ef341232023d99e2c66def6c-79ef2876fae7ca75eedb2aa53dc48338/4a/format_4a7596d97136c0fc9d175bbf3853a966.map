{"version":3,"sources":["/workspace/src/format.ts"],"sourcesContent":["// Noolang value pretty-printer/formatter\n// Usage: formatValue(value: Value): string\n\nimport {\n\tisNumber,\n\tisString,\n\tisBool,\n\tisList,\n\tisRecord,\n\tisTuple,\n\tisFunction,\n\tisNativeFunction,\n\tisUnit,\n\tisConstructor,\n\ttype Value,\n\tboolValue,\n} from \"./evaluator\";\n\nexport function formatValue(value: Value): string {\n  if (isNumber(value)) {\n    return value.value.toString();\n  }\n  if (isString(value)) {\n    // Escape quotes and backslashes\n\t\treturn `\"${value.value.replace(/\\\\/g, \"\\\\\\\\\").replace(/\"/g, '\\\\\"')}\"`;\n  }\n  if (isBool(value)) {\n    return boolValue(value) ? \"True\" : \"False\";\n  }\n  if (isList(value)) {\n    return `[${value.values.map(formatValue).join(\"; \")}]`;\n  }\n  if (isTuple(value)) {\n\t\t\treturn `{${value.values.map(formatValue).join(\"; \")}}`;\n\t\t}\n  if (isRecord(value)) {\n    return `{${Object.entries(value.fields)\n\t\t\t\t\t.map(([k, v]) => `@${k} ${formatValue(v)}`)\n\t\t\t\t\t.join(\"; \")}}`;\n  }\n  if (isFunction(value)) {\n    return \"<function>\";\n  }\n  if (isNativeFunction(value)) {\n    return `<native:${value.name}>`;\n  }\n  if (isUnit(value)) {\n    return \"()\";\n  }\n  if (isConstructor(value)) {\n    if (value.args.length === 0) {\n      return value.name;\n    } else {\n      return `${value.name} ${value.args.map(formatValue).join(\" \")}`;\n    }\n  }\n  return \"<unknown>\";\n}\n\nexport default formatValue;\n"],"names":["formatValue","value","isNumber","toString","isString","replace","isBool","boolValue","isList","values","map","join","isTuple","isRecord","Object","entries","fields","k","v","isFunction","isNativeFunction","name","isUnit","isConstructor","args","length"],"mappings":"AAAA,yCAAyC;AACzC,2CAA2C;;;;;;;;;;;;QA0D3C;eAAA;;QAzCgBA;eAAAA;;;2BAFT;AAEA,SAASA,YAAYC,KAAY;IACtC,IAAIC,IAAAA,mBAAQ,EAACD,QAAQ;QACnB,OAAOA,MAAMA,KAAK,CAACE,QAAQ;IAC7B;IACA,IAAIC,IAAAA,mBAAQ,EAACH,QAAQ;QACnB,gCAAgC;QAClC,OAAO,CAAC,CAAC,EAAEA,MAAMA,KAAK,CAACI,OAAO,CAAC,OAAO,QAAQA,OAAO,CAAC,MAAM,OAAO,CAAC,CAAC;IACrE;IACA,IAAIC,IAAAA,iBAAM,EAACL,QAAQ;QACjB,OAAOM,IAAAA,oBAAS,EAACN,SAAS,SAAS;IACrC;IACA,IAAIO,IAAAA,iBAAM,EAACP,QAAQ;QACjB,OAAO,CAAC,CAAC,EAAEA,MAAMQ,MAAM,CAACC,GAAG,CAACV,aAAaW,IAAI,CAAC,MAAM,CAAC,CAAC;IACxD;IACA,IAAIC,IAAAA,kBAAO,EAACX,QAAQ;QACnB,OAAO,CAAC,CAAC,EAAEA,MAAMQ,MAAM,CAACC,GAAG,CAACV,aAAaW,IAAI,CAAC,MAAM,CAAC,CAAC;IACvD;IACA,IAAIE,IAAAA,mBAAQ,EAACZ,QAAQ;QACnB,OAAO,CAAC,CAAC,EAAEa,OAAOC,OAAO,CAACd,MAAMe,MAAM,EACpCN,GAAG,CAAC,CAAC,CAACO,GAAGC,EAAE,GAAK,CAAC,CAAC,EAAED,EAAE,CAAC,EAAEjB,YAAYkB,IAAI,EACzCP,IAAI,CAAC,MAAM,CAAC,CAAC;IACjB;IACA,IAAIQ,IAAAA,qBAAU,EAAClB,QAAQ;QACrB,OAAO;IACT;IACA,IAAImB,IAAAA,2BAAgB,EAACnB,QAAQ;QAC3B,OAAO,CAAC,QAAQ,EAAEA,MAAMoB,IAAI,CAAC,CAAC,CAAC;IACjC;IACA,IAAIC,IAAAA,iBAAM,EAACrB,QAAQ;QACjB,OAAO;IACT;IACA,IAAIsB,IAAAA,wBAAa,EAACtB,QAAQ;QACxB,IAAIA,MAAMuB,IAAI,CAACC,MAAM,KAAK,GAAG;YAC3B,OAAOxB,MAAMoB,IAAI;QACnB,OAAO;YACL,OAAO,GAAGpB,MAAMoB,IAAI,CAAC,CAAC,EAAEpB,MAAMuB,IAAI,CAACd,GAAG,CAACV,aAAaW,IAAI,CAAC,MAAM;QACjE;IACF;IACA,OAAO;AACT;MAEA,WAAeX"}