1cb699ce2d6dbc135f505d89d9049311
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _types = require("../types");
const _ast = require("../../ast");
describe('Trait System Infrastructure', ()=>{
    test('should create empty constraint registry', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        expect(registry.size).toBe(0);
    });
    test('should add constraint definition', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        const showSignature = {
            name: 'Show',
            typeParam: 'a',
            functions: new Map([
                [
                    'show',
                    (0, _ast.functionType)([
                        (0, _ast.intType)()
                    ], (0, _ast.stringType)())
                ]
            ])
        };
        (0, _types.addConstraintDefinition)(registry, 'Show', showSignature);
        expect(registry.size).toBe(1);
        expect(registry.has('Show')).toBe(true);
        const constraint = registry.get('Show');
        expect(constraint?.signature.name).toBe('Show');
        expect(constraint?.signature.typeParam).toBe('a');
        expect(constraint?.implementations.size).toBe(0);
    });
    test('should add constraint implementation', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        // Add constraint definition first
        const showSignature = {
            name: 'Show',
            typeParam: 'a',
            functions: new Map([
                [
                    'show',
                    (0, _ast.functionType)([
                        (0, _ast.intType)()
                    ], (0, _ast.stringType)())
                ]
            ])
        };
        (0, _types.addConstraintDefinition)(registry, 'Show', showSignature);
        // Add implementation
        const implementation = {
            functions: new Map([
                [
                    'show',
                    {
                        type: (0, _ast.functionType)([
                            (0, _ast.intType)()
                        ], (0, _ast.stringType)()),
                        quantifiedVars: [],
                        effects: new Set()
                    }
                ]
            ])
        };
        const success = (0, _types.addConstraintImplementation)(registry, 'Show', 'Int', implementation);
        expect(success).toBe(true);
        const constraint = registry.get('Show');
        expect(constraint?.implementations.size).toBe(1);
        expect(constraint?.implementations.has('Int')).toBe(true);
    });
    test('should fail to add implementation for non-existent constraint', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        const implementation = {
            functions: new Map([
                [
                    'show',
                    {
                        type: (0, _ast.functionType)([
                            (0, _ast.intType)()
                        ], (0, _ast.stringType)()),
                        quantifiedVars: [],
                        effects: new Set()
                    }
                ]
            ])
        };
        const success = (0, _types.addConstraintImplementation)(registry, 'NonExistent', 'Int', implementation);
        expect(success).toBe(false);
    });
    test('should resolve constraint function', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        // Set up constraint
        const showSignature = {
            name: 'Show',
            typeParam: 'a',
            functions: new Map([
                [
                    'show',
                    (0, _ast.functionType)([
                        (0, _ast.intType)()
                    ], (0, _ast.stringType)())
                ]
            ])
        };
        (0, _types.addConstraintDefinition)(registry, 'Show', showSignature);
        // Add implementation  
        const showImpl = {
            type: (0, _ast.functionType)([
                (0, _ast.intType)()
            ], (0, _ast.stringType)()),
            quantifiedVars: [],
            effects: new Set()
        };
        const implementation = {
            functions: new Map([
                [
                    'show',
                    showImpl
                ]
            ])
        };
        (0, _types.addConstraintImplementation)(registry, 'Show', 'Int', implementation);
        // Resolve function
        const resolved = (0, _types.resolveConstraintFunction)(registry, 'Show', 'show', (0, _ast.intType)());
        expect(resolved).toBeTruthy();
        expect(resolved?.type).toEqual((0, _ast.functionType)([
            (0, _ast.intType)()
        ], (0, _ast.stringType)()));
    });
    test('should return null for unresolved constraint function', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        const resolved = (0, _types.resolveConstraintFunction)(registry, 'NonExistent', 'show', (0, _ast.intType)());
        expect(resolved).toBeNull();
    });
    test('should get constraint signature', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        const showSignature = {
            name: 'Show',
            typeParam: 'a',
            functions: new Map([
                [
                    'show',
                    (0, _ast.functionType)([
                        (0, _ast.intType)()
                    ], (0, _ast.stringType)())
                ]
            ])
        };
        (0, _types.addConstraintDefinition)(registry, 'Show', showSignature);
        const retrieved = (0, _types.getConstraintSignature)(registry, 'Show');
        expect(retrieved).toBeTruthy();
        expect(retrieved?.name).toBe('Show');
        expect(retrieved?.typeParam).toBe('a');
        expect(retrieved?.functions.get('show')).toEqual((0, _ast.functionType)([
            (0, _ast.intType)()
        ], (0, _ast.stringType)()));
    });
    test('should handle complex constraint with multiple functions', ()=>{
        const registry = (0, _types.createConstraintRegistry)();
        // Define Monad constraint
        const monadSignature = {
            name: 'Monad',
            typeParam: 'm',
            functions: new Map([
                [
                    'bind',
                    (0, _ast.functionType)([
                        (0, _ast.listTypeWithElement)((0, _ast.intType)()),
                        (0, _ast.functionType)([
                            (0, _ast.intType)()
                        ], (0, _ast.listTypeWithElement)((0, _ast.intType)()))
                    ], (0, _ast.listTypeWithElement)((0, _ast.intType)()))
                ],
                [
                    'pure',
                    (0, _ast.functionType)([
                        (0, _ast.intType)()
                    ], (0, _ast.listTypeWithElement)((0, _ast.intType)()))
                ]
            ])
        };
        (0, _types.addConstraintDefinition)(registry, 'Monad', monadSignature);
        // Add List implementation
        const listImpl = {
            functions: new Map([
                [
                    'bind',
                    {
                        type: (0, _ast.functionType)([
                            (0, _ast.listTypeWithElement)((0, _ast.intType)()),
                            (0, _ast.functionType)([
                                (0, _ast.intType)()
                            ], (0, _ast.listTypeWithElement)((0, _ast.intType)()))
                        ], (0, _ast.listTypeWithElement)((0, _ast.intType)())),
                        quantifiedVars: [
                            'a',
                            'b'
                        ],
                        effects: new Set()
                    }
                ],
                [
                    'pure',
                    {
                        type: (0, _ast.functionType)([
                            (0, _ast.intType)()
                        ], (0, _ast.listTypeWithElement)((0, _ast.intType)())),
                        quantifiedVars: [
                            'a'
                        ],
                        effects: new Set()
                    }
                ]
            ])
        };
        (0, _types.addConstraintImplementation)(registry, 'Monad', 'List Int', listImpl);
        // Test resolution
        const bindResolved = (0, _types.resolveConstraintFunction)(registry, 'Monad', 'bind', (0, _ast.listTypeWithElement)((0, _ast.intType)()));
        const pureResolved = (0, _types.resolveConstraintFunction)(registry, 'Monad', 'pure', (0, _ast.listTypeWithElement)((0, _ast.intType)()));
        expect(bindResolved).toBeTruthy();
        expect(pureResolved).toBeTruthy();
        expect(bindResolved?.quantifiedVars).toEqual([
            'a',
            'b'
        ]);
        expect(pureResolved?.quantifiedVars).toEqual([
            'a'
        ]);
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2Uvc3JjL3R5cGVyL19fdGVzdHNfXy90cmFpdC1zeXN0ZW0udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBcbiAgY3JlYXRlQ29uc3RyYWludFJlZ2lzdHJ5LCBcbiAgYWRkQ29uc3RyYWludERlZmluaXRpb24sIFxuICBhZGRDb25zdHJhaW50SW1wbGVtZW50YXRpb24sIFxuICByZXNvbHZlQ29uc3RyYWludEZ1bmN0aW9uLFxuICBnZXRDb25zdHJhaW50U2lnbmF0dXJlLFxuICB0eXBlIENvbnN0cmFpbnRTaWduYXR1cmUsXG4gIHR5cGUgQ29uc3RyYWludEltcGxlbWVudGF0aW9uXG59IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IGludFR5cGUsIHN0cmluZ1R5cGUsIGZ1bmN0aW9uVHlwZSwgbGlzdFR5cGVXaXRoRWxlbWVudCB9IGZyb20gJy4uLy4uL2FzdCc7XG5cbmRlc2NyaWJlKCdUcmFpdCBTeXN0ZW0gSW5mcmFzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBjcmVhdGUgZW1wdHkgY29uc3RyYWludCByZWdpc3RyeScsICgpID0+IHtcbiAgICBjb25zdCByZWdpc3RyeSA9IGNyZWF0ZUNvbnN0cmFpbnRSZWdpc3RyeSgpO1xuICAgIGV4cGVjdChyZWdpc3RyeS5zaXplKS50b0JlKDApO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgYWRkIGNvbnN0cmFpbnQgZGVmaW5pdGlvbicsICgpID0+IHtcbiAgICBjb25zdCByZWdpc3RyeSA9IGNyZWF0ZUNvbnN0cmFpbnRSZWdpc3RyeSgpO1xuICAgIFxuICAgIGNvbnN0IHNob3dTaWduYXR1cmU6IENvbnN0cmFpbnRTaWduYXR1cmUgPSB7XG4gICAgICBuYW1lOiAnU2hvdycsXG4gICAgICB0eXBlUGFyYW06ICdhJyxcbiAgICAgIGZ1bmN0aW9uczogbmV3IE1hcChbXG4gICAgICAgIFsnc2hvdycsIGZ1bmN0aW9uVHlwZShbaW50VHlwZSgpXSwgc3RyaW5nVHlwZSgpKV1cbiAgICAgIF0pXG4gICAgfTtcblxuICAgIGFkZENvbnN0cmFpbnREZWZpbml0aW9uKHJlZ2lzdHJ5LCAnU2hvdycsIHNob3dTaWduYXR1cmUpO1xuICAgIFxuICAgIGV4cGVjdChyZWdpc3RyeS5zaXplKS50b0JlKDEpO1xuICAgIGV4cGVjdChyZWdpc3RyeS5oYXMoJ1Nob3cnKSkudG9CZSh0cnVlKTtcbiAgICBcbiAgICBjb25zdCBjb25zdHJhaW50ID0gcmVnaXN0cnkuZ2V0KCdTaG93Jyk7XG4gICAgZXhwZWN0KGNvbnN0cmFpbnQ/LnNpZ25hdHVyZS5uYW1lKS50b0JlKCdTaG93Jyk7XG4gICAgZXhwZWN0KGNvbnN0cmFpbnQ/LnNpZ25hdHVyZS50eXBlUGFyYW0pLnRvQmUoJ2EnKTtcbiAgICBleHBlY3QoY29uc3RyYWludD8uaW1wbGVtZW50YXRpb25zLnNpemUpLnRvQmUoMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBhZGQgY29uc3RyYWludCBpbXBsZW1lbnRhdGlvbicsICgpID0+IHtcbiAgICBjb25zdCByZWdpc3RyeSA9IGNyZWF0ZUNvbnN0cmFpbnRSZWdpc3RyeSgpO1xuICAgIFxuICAgIC8vIEFkZCBjb25zdHJhaW50IGRlZmluaXRpb24gZmlyc3RcbiAgICBjb25zdCBzaG93U2lnbmF0dXJlOiBDb25zdHJhaW50U2lnbmF0dXJlID0ge1xuICAgICAgbmFtZTogJ1Nob3cnLFxuICAgICAgdHlwZVBhcmFtOiAnYScsIFxuICAgICAgZnVuY3Rpb25zOiBuZXcgTWFwKFtcbiAgICAgICAgWydzaG93JywgZnVuY3Rpb25UeXBlKFtpbnRUeXBlKCldLCBzdHJpbmdUeXBlKCkpXVxuICAgICAgXSlcbiAgICB9O1xuICAgIGFkZENvbnN0cmFpbnREZWZpbml0aW9uKHJlZ2lzdHJ5LCAnU2hvdycsIHNob3dTaWduYXR1cmUpO1xuXG4gICAgLy8gQWRkIGltcGxlbWVudGF0aW9uXG4gICAgY29uc3QgaW1wbGVtZW50YXRpb246IENvbnN0cmFpbnRJbXBsZW1lbnRhdGlvbiA9IHtcbiAgICAgIGZ1bmN0aW9uczogbmV3IE1hcChbXG4gICAgICAgIFsnc2hvdycsIHtcbiAgICAgICAgICB0eXBlOiBmdW5jdGlvblR5cGUoW2ludFR5cGUoKV0sIHN0cmluZ1R5cGUoKSksXG4gICAgICAgICAgcXVhbnRpZmllZFZhcnM6IFtdLFxuICAgICAgICAgIGVmZmVjdHM6IG5ldyBTZXQoKVxuICAgICAgICB9XVxuICAgICAgXSlcbiAgICB9O1xuXG4gICAgY29uc3Qgc3VjY2VzcyA9IGFkZENvbnN0cmFpbnRJbXBsZW1lbnRhdGlvbihyZWdpc3RyeSwgJ1Nob3cnLCAnSW50JywgaW1wbGVtZW50YXRpb24pO1xuICAgIFxuICAgIGV4cGVjdChzdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIFxuICAgIGNvbnN0IGNvbnN0cmFpbnQgPSByZWdpc3RyeS5nZXQoJ1Nob3cnKTtcbiAgICBleHBlY3QoY29uc3RyYWludD8uaW1wbGVtZW50YXRpb25zLnNpemUpLnRvQmUoMSk7XG4gICAgZXhwZWN0KGNvbnN0cmFpbnQ/LmltcGxlbWVudGF0aW9ucy5oYXMoJ0ludCcpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgZmFpbCB0byBhZGQgaW1wbGVtZW50YXRpb24gZm9yIG5vbi1leGlzdGVudCBjb25zdHJhaW50JywgKCkgPT4ge1xuICAgIGNvbnN0IHJlZ2lzdHJ5ID0gY3JlYXRlQ29uc3RyYWludFJlZ2lzdHJ5KCk7XG4gICAgXG4gICAgY29uc3QgaW1wbGVtZW50YXRpb246IENvbnN0cmFpbnRJbXBsZW1lbnRhdGlvbiA9IHtcbiAgICAgIGZ1bmN0aW9uczogbmV3IE1hcChbXG4gICAgICAgIFsnc2hvdycsIHtcbiAgICAgICAgICB0eXBlOiBmdW5jdGlvblR5cGUoW2ludFR5cGUoKV0sIHN0cmluZ1R5cGUoKSksXG4gICAgICAgICAgcXVhbnRpZmllZFZhcnM6IFtdLFxuICAgICAgICAgIGVmZmVjdHM6IG5ldyBTZXQoKVxuICAgICAgICB9XVxuICAgICAgXSlcbiAgICB9O1xuXG4gICAgY29uc3Qgc3VjY2VzcyA9IGFkZENvbnN0cmFpbnRJbXBsZW1lbnRhdGlvbihyZWdpc3RyeSwgJ05vbkV4aXN0ZW50JywgJ0ludCcsIGltcGxlbWVudGF0aW9uKTtcbiAgICBcbiAgICBleHBlY3Qoc3VjY2VzcykudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCByZXNvbHZlIGNvbnN0cmFpbnQgZnVuY3Rpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgcmVnaXN0cnkgPSBjcmVhdGVDb25zdHJhaW50UmVnaXN0cnkoKTtcbiAgICBcbiAgICAvLyBTZXQgdXAgY29uc3RyYWludFxuICAgIGNvbnN0IHNob3dTaWduYXR1cmU6IENvbnN0cmFpbnRTaWduYXR1cmUgPSB7XG4gICAgICBuYW1lOiAnU2hvdycsXG4gICAgICB0eXBlUGFyYW06ICdhJyxcbiAgICAgIGZ1bmN0aW9uczogbmV3IE1hcChbXG4gICAgICAgIFsnc2hvdycsIGZ1bmN0aW9uVHlwZShbaW50VHlwZSgpXSwgc3RyaW5nVHlwZSgpKV1cbiAgICAgIF0pXG4gICAgfTtcbiAgICBhZGRDb25zdHJhaW50RGVmaW5pdGlvbihyZWdpc3RyeSwgJ1Nob3cnLCBzaG93U2lnbmF0dXJlKTtcblxuICAgIC8vIEFkZCBpbXBsZW1lbnRhdGlvbiAgXG4gICAgY29uc3Qgc2hvd0ltcGwgPSB7XG4gICAgICB0eXBlOiBmdW5jdGlvblR5cGUoW2ludFR5cGUoKV0sIHN0cmluZ1R5cGUoKSksXG4gICAgICBxdWFudGlmaWVkVmFyczogW10sXG4gICAgICBlZmZlY3RzOiBuZXcgU2V0PGltcG9ydCgnLi4vLi4vYXN0JykuRWZmZWN0PigpXG4gICAgfTtcbiAgICBjb25zdCBpbXBsZW1lbnRhdGlvbjogQ29uc3RyYWludEltcGxlbWVudGF0aW9uID0ge1xuICAgICAgZnVuY3Rpb25zOiBuZXcgTWFwKFtbJ3Nob3cnLCBzaG93SW1wbF1dKVxuICAgIH07XG4gICAgYWRkQ29uc3RyYWludEltcGxlbWVudGF0aW9uKHJlZ2lzdHJ5LCAnU2hvdycsICdJbnQnLCBpbXBsZW1lbnRhdGlvbik7XG5cbiAgICAvLyBSZXNvbHZlIGZ1bmN0aW9uXG4gICAgY29uc3QgcmVzb2x2ZWQgPSByZXNvbHZlQ29uc3RyYWludEZ1bmN0aW9uKHJlZ2lzdHJ5LCAnU2hvdycsICdzaG93JywgaW50VHlwZSgpKTtcbiAgICBcbiAgICBleHBlY3QocmVzb2x2ZWQpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocmVzb2x2ZWQ/LnR5cGUpLnRvRXF1YWwoZnVuY3Rpb25UeXBlKFtpbnRUeXBlKCldLCBzdHJpbmdUeXBlKCkpKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIHJldHVybiBudWxsIGZvciB1bnJlc29sdmVkIGNvbnN0cmFpbnQgZnVuY3Rpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgcmVnaXN0cnkgPSBjcmVhdGVDb25zdHJhaW50UmVnaXN0cnkoKTtcbiAgICBcbiAgICBjb25zdCByZXNvbHZlZCA9IHJlc29sdmVDb25zdHJhaW50RnVuY3Rpb24ocmVnaXN0cnksICdOb25FeGlzdGVudCcsICdzaG93JywgaW50VHlwZSgpKTtcbiAgICBcbiAgICBleHBlY3QocmVzb2x2ZWQpLnRvQmVOdWxsKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBnZXQgY29uc3RyYWludCBzaWduYXR1cmUnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVnaXN0cnkgPSBjcmVhdGVDb25zdHJhaW50UmVnaXN0cnkoKTtcbiAgICBcbiAgICBjb25zdCBzaG93U2lnbmF0dXJlOiBDb25zdHJhaW50U2lnbmF0dXJlID0ge1xuICAgICAgbmFtZTogJ1Nob3cnLFxuICAgICAgdHlwZVBhcmFtOiAnYScsXG4gICAgICBmdW5jdGlvbnM6IG5ldyBNYXAoW1xuICAgICAgICBbJ3Nob3cnLCBmdW5jdGlvblR5cGUoW2ludFR5cGUoKV0sIHN0cmluZ1R5cGUoKSldXG4gICAgICBdKVxuICAgIH07XG4gICAgYWRkQ29uc3RyYWludERlZmluaXRpb24ocmVnaXN0cnksICdTaG93Jywgc2hvd1NpZ25hdHVyZSk7XG5cbiAgICBjb25zdCByZXRyaWV2ZWQgPSBnZXRDb25zdHJhaW50U2lnbmF0dXJlKHJlZ2lzdHJ5LCAnU2hvdycpO1xuICAgIFxuICAgIGV4cGVjdChyZXRyaWV2ZWQpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocmV0cmlldmVkPy5uYW1lKS50b0JlKCdTaG93Jyk7XG4gICAgZXhwZWN0KHJldHJpZXZlZD8udHlwZVBhcmFtKS50b0JlKCdhJyk7XG4gICAgZXhwZWN0KHJldHJpZXZlZD8uZnVuY3Rpb25zLmdldCgnc2hvdycpKS50b0VxdWFsKGZ1bmN0aW9uVHlwZShbaW50VHlwZSgpXSwgc3RyaW5nVHlwZSgpKSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY29tcGxleCBjb25zdHJhaW50IHdpdGggbXVsdGlwbGUgZnVuY3Rpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IHJlZ2lzdHJ5ID0gY3JlYXRlQ29uc3RyYWludFJlZ2lzdHJ5KCk7XG4gICAgXG4gICAgLy8gRGVmaW5lIE1vbmFkIGNvbnN0cmFpbnRcbiAgICBjb25zdCBtb25hZFNpZ25hdHVyZTogQ29uc3RyYWludFNpZ25hdHVyZSA9IHtcbiAgICAgIG5hbWU6ICdNb25hZCcsXG4gICAgICB0eXBlUGFyYW06ICdtJyxcbiAgICAgIGZ1bmN0aW9uczogbmV3IE1hcChbXG4gICAgICAgIFsnYmluZCcsIGZ1bmN0aW9uVHlwZShbXG4gICAgICAgICAgbGlzdFR5cGVXaXRoRWxlbWVudChpbnRUeXBlKCkpLCBcbiAgICAgICAgICBmdW5jdGlvblR5cGUoW2ludFR5cGUoKV0sIGxpc3RUeXBlV2l0aEVsZW1lbnQoaW50VHlwZSgpKSlcbiAgICAgICAgXSwgbGlzdFR5cGVXaXRoRWxlbWVudChpbnRUeXBlKCkpKV0sXG4gICAgICAgIFsncHVyZScsIGZ1bmN0aW9uVHlwZShbaW50VHlwZSgpXSwgbGlzdFR5cGVXaXRoRWxlbWVudChpbnRUeXBlKCkpKV1cbiAgICAgIF0pXG4gICAgfTtcbiAgICBhZGRDb25zdHJhaW50RGVmaW5pdGlvbihyZWdpc3RyeSwgJ01vbmFkJywgbW9uYWRTaWduYXR1cmUpO1xuXG4gICAgLy8gQWRkIExpc3QgaW1wbGVtZW50YXRpb25cbiAgICBjb25zdCBsaXN0SW1wbDogQ29uc3RyYWludEltcGxlbWVudGF0aW9uID0ge1xuICAgICAgZnVuY3Rpb25zOiBuZXcgTWFwKFtcbiAgICAgICAgWydiaW5kJywge1xuICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uVHlwZShbXG4gICAgICAgICAgICBsaXN0VHlwZVdpdGhFbGVtZW50KGludFR5cGUoKSksIFxuICAgICAgICAgICAgZnVuY3Rpb25UeXBlKFtpbnRUeXBlKCldLCBsaXN0VHlwZVdpdGhFbGVtZW50KGludFR5cGUoKSkpXG4gICAgICAgICAgXSwgbGlzdFR5cGVXaXRoRWxlbWVudChpbnRUeXBlKCkpKSxcbiAgICAgICAgICBxdWFudGlmaWVkVmFyczogWydhJywgJ2InXSxcbiAgICAgICAgICBlZmZlY3RzOiBuZXcgU2V0KClcbiAgICAgICAgfV0sXG4gICAgICAgIFsncHVyZScsIHtcbiAgICAgICAgICB0eXBlOiBmdW5jdGlvblR5cGUoW2ludFR5cGUoKV0sIGxpc3RUeXBlV2l0aEVsZW1lbnQoaW50VHlwZSgpKSksXG4gICAgICAgICAgcXVhbnRpZmllZFZhcnM6IFsnYSddLCBcbiAgICAgICAgICBlZmZlY3RzOiBuZXcgU2V0KClcbiAgICAgICAgfV1cbiAgICAgIF0pXG4gICAgfTtcbiAgICBhZGRDb25zdHJhaW50SW1wbGVtZW50YXRpb24ocmVnaXN0cnksICdNb25hZCcsICdMaXN0IEludCcsIGxpc3RJbXBsKTtcblxuICAgIC8vIFRlc3QgcmVzb2x1dGlvblxuICAgIGNvbnN0IGJpbmRSZXNvbHZlZCA9IHJlc29sdmVDb25zdHJhaW50RnVuY3Rpb24oXG4gICAgICByZWdpc3RyeSwgXG4gICAgICAnTW9uYWQnLCBcbiAgICAgICdiaW5kJywgXG4gICAgICBsaXN0VHlwZVdpdGhFbGVtZW50KGludFR5cGUoKSlcbiAgICApO1xuICAgIGNvbnN0IHB1cmVSZXNvbHZlZCA9IHJlc29sdmVDb25zdHJhaW50RnVuY3Rpb24oXG4gICAgICByZWdpc3RyeSxcbiAgICAgICdNb25hZCcsIFxuICAgICAgJ3B1cmUnLFxuICAgICAgbGlzdFR5cGVXaXRoRWxlbWVudChpbnRUeXBlKCkpXG4gICAgKTtcblxuICAgIGV4cGVjdChiaW5kUmVzb2x2ZWQpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocHVyZVJlc29sdmVkKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGJpbmRSZXNvbHZlZD8ucXVhbnRpZmllZFZhcnMpLnRvRXF1YWwoWydhJywgJ2InXSk7XG4gICAgZXhwZWN0KHB1cmVSZXNvbHZlZD8ucXVhbnRpZmllZFZhcnMpLnRvRXF1YWwoWydhJ10pO1xuICB9KTtcbn0pOyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsInRlc3QiLCJyZWdpc3RyeSIsImNyZWF0ZUNvbnN0cmFpbnRSZWdpc3RyeSIsImV4cGVjdCIsInNpemUiLCJ0b0JlIiwic2hvd1NpZ25hdHVyZSIsIm5hbWUiLCJ0eXBlUGFyYW0iLCJmdW5jdGlvbnMiLCJNYXAiLCJmdW5jdGlvblR5cGUiLCJpbnRUeXBlIiwic3RyaW5nVHlwZSIsImFkZENvbnN0cmFpbnREZWZpbml0aW9uIiwiaGFzIiwiY29uc3RyYWludCIsImdldCIsInNpZ25hdHVyZSIsImltcGxlbWVudGF0aW9ucyIsImltcGxlbWVudGF0aW9uIiwidHlwZSIsInF1YW50aWZpZWRWYXJzIiwiZWZmZWN0cyIsIlNldCIsInN1Y2Nlc3MiLCJhZGRDb25zdHJhaW50SW1wbGVtZW50YXRpb24iLCJzaG93SW1wbCIsInJlc29sdmVkIiwicmVzb2x2ZUNvbnN0cmFpbnRGdW5jdGlvbiIsInRvQmVUcnV0aHkiLCJ0b0VxdWFsIiwidG9CZU51bGwiLCJyZXRyaWV2ZWQiLCJnZXRDb25zdHJhaW50U2lnbmF0dXJlIiwibW9uYWRTaWduYXR1cmUiLCJsaXN0VHlwZVdpdGhFbGVt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