# Test case that might reveal performance issues

# Multiple ADT definitions
type Color = Red | Green | Blue;
type Shape a = Circle a | Rectangle a a | Triangle a a a;
type Point a = Point a a;

# Simple functions
add = fn x y => x + y;
multiply = fn x y => x * y;
square = fn x => x * x;

# ADT functions
color_to_number = fn color => match color with (
  Red => 1;
  Green => 2;
  Blue => 3
);

calculate_area = fn shape => match shape with (
  Circle radius => radius * radius * 3;
  Rectangle width height => width * height;
  Triangle a b c => (a * b) / 2
);

get_x = fn point => match point with (Point x y => x);
get_y = fn point => match point with (Point x y => y);

# Create some data
colors = [Red, Green, Blue, Red, Green];
shapes = [Circle 3, Rectangle 5 4, Triangle 2 3 4];
points = [Point 0 0, Point 1 2, Point 3 4];

# Apply functions
color_numbers = map color_to_number colors;
areas = map calculate_area shapes;
x_coords = map get_x points;
y_coords = map get_y points;

# Final result
{ @colors color_numbers, @areas areas, @x_coords x_coords, @y_coords y_coords }